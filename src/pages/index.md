---
title: ПСБ Гайды
---
# ПСБ Гайды

Работая с дизайн-системой и наблюдая за процессами команды ДС, появилось несколько предложений по улучшению или изменению следующих процессов:
1. Хранение документации по дизайну
2. Создание витрины компонентов и хранение фронтовой документации
3. Покрытие автоматическими тестами компонентов ДС
4. Изменение в регламенте движения задач ДС

## Хранение документации по дизайну
### Проблематика
* Нет единого источника правды по компонентам: 
    * Часть описания хранится в Фигме, а часть в Ноушене.
    * Непонятно какое описание самое актуальное.
    * Приходится следить и поддерживать два источника.
    * У разработчиков есть сторибук, но нет перелинковки между желаемым результатом и реализацией.
* Нет перелинковки с бэклогом по компоненту, непонятно когда будет реализован компонент, взят ли он в работу, какие дефекты есть по реализованному компоненту.
* Фигма не подходит для хранения документации.
* Ноушен подходит лучше, но возникает зависимость от платформы:
  * Риск блокировки и потери данных.
  * Платные функции (домен, хостинг файлов, ролевая модель, аналитика), за которые еще надо как-то смочь заплатить.

### Предложение
* Отказаться от хранения текстового описания компонентов в Фигме. Хранить там только состояния компонентов и типовые экраны.
* Отказаться от хранения документации в Ноушене.
* Перейти на хранение документации в формате .md и .mdx в репозитории банка.
* Использовать для сборки документации опенсорсные решения: Docusaurus, VuePress, 11ty.

### Польза
* Защитимся от рисков блокировки, а значит обезопасим инвестиции в документацию.
* Создадим единый источник правды для всех участников процесса разработки: дизайнеров, аналитиков, разработчиков и тестировщиков.
* Свяжем документацию, фигму, сторибук и бэклог.
* Сделаем документацию публичной. Такой подход может стать генератором имиджевого капитала среди it-специалистов, через демонстрацию нашей инженерной культуры.
* Сможем настроить версионирование документации.
* Разрешим предлагать изменения к документации всем участникам. Т.е. необязательно быть членом команды ДС, чтобы что-то написать в ДС, можно предложить изменения к документации не имея прав. А редактор/дизайнер ДС решит принимать изменения или нет.
* Внедрим глобальный поиск по содержимому.
* Поднимем аналитику использования документации через Яндекс.Метрику и начнем сбор обратной связи:
  * Узнаем какие вопросы возникают у пользователей чаще всего.
  * Каким вещам нужно уделить больше внимания.
  * Сколько людей вообще пользуются документацией.
  * Удовлетворены ли они качеством документации.

## Витрина компонентов и автотесты
### Проблематика
Так как Фигма хранит лишь ожидаемый результат, должен быть инструмент,
который хранит — фактический.

### Предложение
Внедрить в релизный цикл работу со опенсорсным решением — Storybook.
Он уже используется для вебовских компонентов, но доступен только
фронтам и неизвестно всем ли. Надо расшарить его на всех участников
производственного цикла и связать со всеми остальными инструментами.

### Польза
1. Визуализация фактическое состояние компонента для дизайнера.
2. Удобный и быстрый поиск нужного компонента для фронта.
3. Вся необходимая документация для фронта по использованию компонента.
4. Встроенная функция комментирования компонентов, аналогичная Фигме.
Проходить дизайн-ревью, можно так же быстро и удобно как инспекцию в
Фигме.
5. Возможность внедрения регрессионного тестирования
компонентов с помощью автотестов через Chromatic. Это логичный
следующий шаг развития Сторибука, который позволит ускорить процесс
тестирования (выявлять проблемы на ранних этапах, быстрее проводить
регресс) и повысит уверенность в сборках. Так как тесты
визуализируются в хроматике, принимать решения о принятии изменений
или их отклонении могут помогать дизайнеры.

## Изменение в регламенте движения задач ДС
### Проблематика
1. Мы каждый день сталкиваемся с неактуальной версией компонентов в Фигме. Это происходит из-за того, что дизайнер вливает изменения в мастер-ветку раньше фронта.
2. Нам приходится использовать старые компоненты, находящиеся под меткой «Dont Use».
3. Это противоречит правилам инспекций и по идее, такие макеты не должны пройти инспекцию, но мы закрываем на это глаза.
4. Мы не подтягиваем изменения из ДС в наши макеты из-за страха поломать всё вокруг. Так быть не должно, потому что ДС — это мастер-ветка и все наши макеты должны жить в полном соответствии.
5. Доработка или разработка новых компонентов в рамках текущих продуктовых команд невозможна, так как оттягивает сроки реализации продукта.

Принудительное обновление макетов до нереализованных компонентов не решает проблему. Проблема несоответствия макетов возникнет позже, в момент дизайн-ревью.

### Предложение
Внести изменение в регламент движения задач:
![](../pages/img/guides.jpg)

### Польза
1. Победа над неактуальными компонентами в ДС. Дизайнер вливается в мастер позже разработчика.
2. Полная прозрачность движения задач за счет объединения бэклогов: понятны объемы, узкие места и сроки реализации.
3. Наведение порядка в процессах через внедрение скрамовских событий: планирования и груминга.

## Идеология инструментов
У каждого инструмента есть зона ответственности для которой он был создан и чтобы не смешивать их, нам следует договориться и принять идеологию каждого инструмента.

1. Фигма — хранит ожидаемый результат по внешнему виду компонентов, примеры и шаблоны экранов.
2. Docusaurus — хранит текстовое описание работы и использования компонентов, принципы проектирования интерфейсов и редполитику.
3. Трекер — хранит бэклог задач на доработку дизайн-системы, баги и технический долг.
4. Storybook — визуализирует фактический результат реализованных компонентов, хранит документацию для фронтенд-разработчиков, позволяет проходить дизайн-ревью.
5. Chromatic — покрывает компоненты автотестами и обеспечивает дополнительную уверенность в качестве сборок. 

Ни один из инструментов не претендует на хранение исчерпывающей информации по компоненту и поэтому, содержит ссылки на остальные инструменты для дополнения.

Этот сайт был создан для демонстрации возможностей инструмента Docusaurus, предназначенного для хранения текстового описания работы компонентов. В качестве примера собрана одна образцовая страница о компоненте «[Автокомплит](./components/combobox)».

Такой подход к организации хранения, документирования и визуализации компонентов не новый, вот несколько примеров с похожей реализацией:
* [Дизайн-система Ростелекома](https://design.rt.ru/components/btn/guide)
* [Контур Гайды](https://guides.kontur.ru/)
* [Дизайн-система Альфа-банка](https://www.youtube.com/watch?v=vKqh7VO9E3I)

## Рефакторинг ДС
Можно немного [упростить заполнение информации о компонентах](https://docs.google.com/document/d/1FGnhePut0HSxc-7y-L0YqwD6IOv8J4J5UpW8uBasy_U/edit?usp=sharing) со стороны участников дизайн-системы.

## Экономическое обоснование проекта
### Хранение документации
Хранить документацию мы будем в репозитории банка. Это защитит результаты интеллектуального труда от внешнего воздействия, а значит бизнес не потеряет инвестиции, вложенные в производство документации. Храниться документация будет в форматах md, mdx, jpeg. Для хранения понадобится около гигабайта дискового пространства. Скорее всего, у банка локальный гитлаб с бесплатными учётными записями. 

### Сборка документации
Для сборки будем использовать опенсорсные решения это бесплатно и надежно. Для примера можно выделить несколько решений: Docusaurus, VuePress, 11ty. Я склоняюсь к Docusaurus, эту тему можно обсуждать в отдельной ветке. Надежность подхода заключается в том, что любые решения по этой части легкозаменяемы. Это значит, что в случае компрометации выбранного нами решения мы ничего не теряем, так как используем стороннее решение только для генерации статики, а весь контент лежит в нашем репозитории. Поэтому, мы просто меняем генератор и все снова работает.

### Деплой документации
Нам нужен доступ на один из серверов банка. У нас низкотребовательная сборка, так как все хранится в статике. Т. е. нам подойдет самый простой сервер из имеющихся и 1 гигабайт места на дисковом пространстве. Возможно, можно будет положить на тот же сервер, что и сторибук. Для настройки автоматического деплоя документации на сервер необходимо будет разово привлечь девопса.

### Сертификат безопасности для поддомена
Так как документация будет храниться на поддомене банка, то каждый год, нам надо выпускать сертификат безопасности. Тут все зависит от текущих сертов банка, если они поддерживают поддомены, то ничего делать не придется, если не поддерживают, то придется купить новый сертификат или обсудить использование бесплатного сертификата. Платные сертификаты нам без надобности. Нечего защищать.

### Сторибук
Похож на Докусаурус, тоже бесплатный, требует место в репозитории, на сервере, автодеплой и сертификат, но дополнительно требует отдельной настройки для развертывания на дев и препрод стендах для прохождения дизайн-ревью.

### Chromatic
Если репозиторий с фронтом будет открытым, то использовать хроматик можно бесплатно. Иначе — от 150$ до 650$ в месяц. Но его использование следует обсуждать с фронтами. Каким они видят развитие ДС и как собираются тестить?

### Фигма
Для поддержки ветвления потребуется план Organization или Enterprise. Такой план нужен для всех участников ДС — 15 человек.

### Выделенная команда фронтов на ДС
Так как на реализацию ДС у разработчиков выделяется 1 день в неделю, а ни одна задача не успеет пройти по релизному циклу за такой срок, то задача будет переноситься на следующую неделю и так далее. Здесь у нас узкое горлышко. Прежде чем считать команду, следует определиться с объемом бэклога, использованием сторибука и хроматика. 

### Итого
| Расход                                                  | Стоимость                |
| ------------------------------------------------------- | ------------------------ |
| Хранение и серверные мощности для докусаурус и сторибук | 10 000 ₽ в год           |
| Настройка автоматического деплоя по ставке депопса      | 10 000 ₽ за раз          |
| SSL-сертификаты                                         | Бесплатно                |
| Фигма (Organization Plan)                               | 45$ * 15 = 675$ в мес    |
| Chromatic                                               | Бесплатно или 349$ в мес |
| Команда разработчиков                                   | —                        |
| Оснащение разработчиков                                 | —                        |