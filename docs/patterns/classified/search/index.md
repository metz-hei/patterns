---
sidebar_position: 1
---

# Поиск по справочникам

Алгоритм поиска подходит для использования в любом справочнике. Ниже описана работа алгоритма на примере справочника «Телефонная книга».

## Компонент

![Компонент поиска](./1.png)

| Параметр          | Значение        |
| :---------------- | :-------------- |
| Компонент         | Input Search bar   |
| Плейсхолдер       | Произвольно    |
| Маска    | Нет          |
| Фокус по умолчанию     | Да/Нет          |
| Снятие фокуса  | 1. Если тапнуть по неактивному месту 2. Если проскроллить листинг значений 3. Нажать на кнопку Отменить |
| Клавиатура | iOS: `asciiCapable` по умолчанию. [В других ситуациях](https://developer.apple.com/design/human-interface-guidelines/virtual-keyboards). Android: ??. Если клавиатура буквенная, то в зависимости от контекста, пытаемся поднять клавиатуру в нужной раскладке. Например, если в поле ожидается ввод русских символов, то поднимаем клавиатуру с русской раскладкой. |

## Алгоритм поиска

### Общие принципы

1. Если вывод значений был с группировкой, то отключать группировку при поиске.
2. Не выделять найденные совпадения в значениях
3. Начинать поиск при вводе первого символа.

### Поиск по телефону

Очищать значение из поиска от всех символов, кроме цифр. Искать совпадения по вхождению без учета всех символов, кроме цифр. Ранжировать выше значения с совпадениями вначале значений.

Если в процессе поиска не нашлось совпадения, но значение в поле поиска похоже на телефон, то форматировать такое значение по маске и предлагать его к выбору:

![Поиск по телефону](./2.png)

**Какие значения считать похожими на российский номер телефона?**
- Любая комбинация из 10 цифр, если она начинается не на 7.
- Любая комбинация из 11 цифр начинающаяся с 7 или 8.

Если пользователь использует при наборе не цифры, то позволять их вводить, но игнорировать при определении номера.

Форматировать российские номера по маске: +7 (000) 000-00-00

Если значение в поле поиска похоже на телефон, но полностью не удовлетворяет принципам похожести, оставлять зону результатов поиска пустой.

![Поиск по телефону](./3.png)

### Поиск по имени контакта

В справочнике контактов есть несколько контактов. DISPLAY_NAME каждого контакта засплитовано по пробелу:

![Поиск по имени контакта](./4.png)

Пользователь вводит значение:

![Поиск по имени контакта](./5.png)

Система осуществляет поиск по вхождению в каждое значение справочника:

![Поиск по имени контакта](./6.png)

Так как в значении `Евгений Николаевич` не нашлось совпадений — отфильтровываем его.

В то же время у трех значений есть совпадение вначале слов, такие контакты показываются выше:

![Поиск по имени контакта](./7.png)

Пользователь продолжает ввод и ставит пробел:

![Поиск по имени контакта](./8.png)

Система интерпретирует это как фиксацию первого ключевого слова. И перестает искать совпадения по вхождению, переходит на поиск по точному совпадению среди найденных ранее значений.

![Поиск по имени контакта](./9.png)

Совпавшие значения исключаются из дальнейшего поиска.

Пользователь продолжает ввод и ставит букву А:

![Поиск по имени контакта](./10.png)

Система продолжает поиск с учетом первого ключевого слова. Система проверяет на предмет вхождения второе ключевое слово во всех значениях найденных ранее контактов.

Совпадения найдены в обоих контактах, но у одного из них есть совпадение вначале значения. Система повышает позицию такого контакта:

![Поиск по имени контакта](./11.png)

Пользователь продолжает ввод и ставит букву л:

![Поиск по имени контакта](./12.png)

Система проверяет на предмет вхождения второе ключевое слово во всех значениях найденных ранее контактов.

Совпадения найдены только в первом:

![Поиск по имени контакта](./13.png)

Если поиск не дал результатов, то выводим сообщение об этом. Текст ошибки может быть изменен в зависимости от названия поля.

![Поиск по имени контакта](./14.png)

## Исключения

В справочнике могут быть значения записанные через букву `ё`: Артём, Пётр, Фёдор, Алёна и другие имена и их производные:

![Список имен, содержащих букву «ё»](./name@2x.png)

Люди вводят `ё` не всегда, гораздо проще ввести букву `е`, но так как наш алгоритм ищет по вхождению, то он не найдет те значения, которые имел ввиду пользователь.

Исправим это и приравняем ввод: `е` = `ё`, `ё` = `е`.
